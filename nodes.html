<!-- 
/*
 * @author     Leonard/Flip
 * @package    ffMap
 * @version    1.0
 * @licenses	CC-BY-SA Creative Commons Namensnennung - Weitergabe unter gleichen Bedingungen 4.0 International Lizenz. https://creativecommons.org/licenses/by-sa/4.0/
 */ 
-->

<html>
	<head> 
		<meta charset="utf-8">
		<!-- jQuery -->
		<script type="text/javascript" charset="utf8" src="//code.jquery.com/jquery-1.10.2.min.js"></script>
		<!-- DataTables CSS -->
		<link rel="stylesheet" type="text/css" href="DataTables/media/css/jquery.dataTables.min.css">   
		<!-- DataTables -->
		<script type="text/javascript" charset="utf8" src="DataTables/media/js/jquery.dataTables.min.js"></script>
	</head>
	<body>
		<p id="nodescount"> </p>
		<p id="nodesloc"> </p>
		<p id="nodeswifi"> </p>
		
		<table id="nodes" class="display" width="100%" cellspacing="0">
			<thead>
				<th class="hidden">Id</th><th>Node</th><th>Mac</th><th>Clients</th><th>Model</th><th>location</th><th>update</th><th>gluon</th><th>release</th>
			</thead>
		</table>
	</body>
</html>

<script>
	$(document).ready(function()
	{	
		$('#nodes').DataTable({
			paging: false,
			columns: [
	        	{ data: "id", visible: false, },
	        	{ data: "Node" },
	            { data: "Mac" },
	            { data: "Clients" },
	            { data: "Model" },
	            { data: "location" },
	            { data: "update" },
	            { data: "gluon" },
	            { data: "release" },
	        ],
		});
		
		$.getJSON("./alfred-json-158.json", function(nodesList){
			
			var nodescount = 0;
			var nodesloc = 0;
			var nodeswifi = 0;
			
			$.each( nodesList, function( key, val ) 
			{					
				$( "#nodes" ).DataTable().row.add( {
					"id": 		val['node_id'],
			        "Node":    	val['hostname'],
			        "Mac": 		val['network']['mac'],
			        "Clients":  "?",//val['network']['addresses'].length,
			        "Model": 	val['hardware']['model'],
			        "location": val['location'] == undefined ? 'no' : 'yes',
			        "update":  	val['software']['autoupdater']['branch'] + "  (" + val['software']['autoupdater']['enabled'] + ")",
			        "gluon": 	val['software']['firmware']['base'],
			        "release": 	val['software']['firmware']['release'],
			    } ).draw();
			    
			    nodescount++;
			    val['location'] == undefined ? null : nodesloc++;
			    nodeswifi += 0;//val['network']['addresses'].length;
			    
			    $("#nodescount").html("Nodes total: " + nodescount);
			    $("#nodesloc").html("Nodes with location: " + nodesloc);
			    $("#nodeswifi").html("Wifi-Clients: " + nodeswifi);
		
			});
		});
		
	});
</script>
